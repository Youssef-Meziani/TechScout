<!-- shop page main wrapper start -->
<div class="main-wrapper pt-35">
  <div class="container-fluid">
    {% if data.laptops|length %}
      <h2 class="pb-35">Search Results for "{{ data.search_query }}"</h2>
    <div class="row">
      <div>
        <div class="product-shop-main-wrapper mb-50">
          <div class="shop-top-bar mb-30">
            <div class="row">
              <div class="col-md-6">
                <div class="top-bar-left">
                  <div class="product-view-mode">
                    <a href="#" data-target="column_3"><span>3-col</span></a>
                    <a href="#" data-target="grid" class="active"><span>4-col</span></a>
                    <a href="#" data-target="list"><span>list</span></a>
                  </div>
                  <div class="product-page">
                    <p>Showing {{ data.showing_from }} to {{ data.showing_to }} of {{ data.total_items }} ({{ data.total_pages }} Pages)</p>
                  </div>
                </div>
              </div>
              <div class="col-md-6">
                <div class="top-bar-right">
                  <div class="per-page">
                    <p>Show : </p>
                    <select class="nice-select" name="per_page" id="per-page-select">
                      <option value="10" {% if data.per_page == 10 %}selected{% endif %}>10</option>
                      <option value="20" {% if data.per_page == 20 %}selected{% endif %}>20</option>
                      <option value="30" {% if data.per_page == 30 %}selected{% endif %}>30</option>
                      <option value="40" {% if data.per_page == 40 %}selected{% endif %}>40</option>
                      <option value="50" {% if data.per_page == 50 %}selected{% endif %}>50</option>
                      <option value="60" {% if data.per_page == 60 %}selected{% endif %}>60</option>
                      <option value="70" {% if data.per_page == 70 %}selected{% endif %}>70</option>
                      <option value="100" {% if data.per_page == 100 %}selected{% endif %}>100</option>
                    </select>
                  </div>
                  <div class="product-short">
                    <p>Sort By : </p>
                    <select class="nice-select" name="sort_by" id="sort-by-select">
                      <option value="relevance" {% if data.sort_by == 'relevance' %}selected{% endif %}>Relevance</option>
                      <option value="name_asc" {% if data.sort_by == 'name_asc' %}selected{% endif %}>Name (A - Z)</option>
                      <option value="name_desc" {% if data.sort_by == 'name_desc' %}selected{% endif %}>Name (Z - A)</option>
                      <option value="price_asc" {% if data.sort_by == 'price_asc' %}selected{% endif %}>Price (Low &gt; High)</option>
                      <option value="price_desc" {% if data.sort_by == 'price_desc' %}selected{% endif %}>Price (High &gt; Low)</option>
                      <option value="rating_asc" {% if data.sort_by == 'rating_asc' %}selected{% endif %}>Rating (Lowest)</option>
                      <option value="rating_desc" {% if data.sort_by == 'rating_desc' %}selected{% endif %}>Rating (Highest)</option>
                    </select>
                  </div>
                </div>
              </div>
            </div>

          </div>
          <div class="shop-product-wrap grid row">

            {% for laptop in data.laptops %}
              <div class="col-lg-3 col-md-4 col-sm-6">
                <div class="product-item mb-30" data-product-id="{{ laptop.id }}" data-product-name="{{ laptop.title }}" data-product-image="assets/img/product/product-1.jpg" data-product-price="{{ laptop.price }} MAD">
                  <div class="product-thumb">
                    <a>
                      <img src="{{ base_path ~ directory ~ '/assets/img/product/product 1.jpg' }}" class="pri-img" alt="">
                      <img src="{{ base_path ~ directory ~ '/assets/img/product/product 2.jpg' }}" class="sec-img" alt="">
                    </a>
                    <div class="box-label">
                      <div class="label-product label_new">
                        <span>new</span>
                      </div>
                    </div>
  {#                          <div class="action-links">#}
  {#                            <a href="#" title="Wishlist"><i class="lnr lnr-heart"></i></a>#}
  {#                            <a href="#" title="Compare" class="compare-button"><i class="lnr lnr-sync"></i></a>#}
  {#                            <a href="#" title="Quick view" data-bs-target="#quickk_view" data-bs-toggle="modal"><i class="lnr lnr-magnifier"></i></a>#}
  {#                          </div>#}
                  </div>
                  <div class="product-caption">
                    <div class="manufacture-product">
                      <p><a href="#">{{ laptop.brand }}</a></p>
                    </div>
                    <div class="product-name">
                      <h4><a href="#">{{ laptop.title }}</a></h4>
                    </div>
                    <div class="ratings">
                      {% set full_stars = (laptop.rating / 20)|round(0, 'floor') %}
                      {% set half_star = (laptop.rating % 20) >= 10 %}
                      {% for i in 1..5 %}
                        {% if i <= full_stars %}
                          <span class="yellow"><i class="lnr lnr-star"></i></span>
                        {% elseif i == full_stars + 1 and half_star %}
                          <span class="yellow"><i class="lnr lnr-star half"></i></span>
                        {% else %}
                          <span><i class="lnr lnr-star"></i></span>
                        {% endif %}
                      {% endfor %}
                    </div>
                    <div class="price-box">
                      <span class="regular-price">{{ laptop.price }} MAD</span>
                    </div>
                    <button class="btn-cart compare-button" type="button">add to compare</button>
                  </div>
                </div> <!-- end single grid item -->
                <div class="sinrato-list-item mb-30">
                  <div class="sinrato-thumb">
                    <a href="product-details.html">
                      <img src="{{ base_path ~ directory ~ '/assets/img/product/product 1.jpg' }}" class="pri-img" alt="">
                      <img src="{{ base_path ~ directory ~ '/assets/img/product/product 2.jpg' }}" class="sec-img" alt="">
                    </a>
                    <div class="box-label">
                      <div class="label-product label_new">
                        <span>new</span>
                      </div>
                    </div>
                  </div>
                  <div class="sinrato-list-item-content">
                    <div class="manufacture-product">
                      <span><a href="#">{{ laptop.brand }}</a></span>
                    </div>
                    <div class="sinrato-product-name">
                      <h4><a href="#">{{ laptop.title }}</a></h4>
                    </div>
                    <div class="sinrato-ratings mb-15">
                      {% set full_stars = (laptop.rating / 20)|round(0, 'floor') %}
                      {% set half_star = (laptop.rating % 20) >= 10 %}
                      {% for i in 1..5 %}
                        {% if i <= full_stars %}
                          <span class="yellow"><i class="lnr lnr-star"></i></span>
                        {% elseif i == full_stars + 1 and half_star %}
                          <span class="yellow"><i class="lnr lnr-star half"></i></span>
                        {% else %}
                          <span><i class="lnr lnr-star"></i></span>
                        {% endif %}
                      {% endfor %}
                    </div>
                    <div class="sinrato-product-des">
                      <p>Canon's press material for the EOS 5D states that it 'defines (a) new D-SLR category', while we're not typically too concerned with marketing talk this particular statement is clearly pretty accurate...</p>
                    </div>
                  </div>
                  <div class="sinrato-box-action">
                    <div class="price-box">
  {#                            <span class="regular-price"><span class="special-price">£50.00</span></span>#}
  {#                            <span class="old-price"><del>£60.00</del></span>#}
                      <span class="regular-price">{{ laptop.price }} MAD</span>
                    </div>
                    <button class="btn-cart compare-button" type="button">add to compare</button>
  {#                          <div class="action-links sinrat-list-icon">#}
  {#                            <a href="#" title="Wishlist"><i class="lnr lnr-heart"></i></a>#}
  {#                            <a href="#" title="Compare"><i class="lnr lnr-sync"></i></a>#}
  {#                            <a href="#" title="Quick view" data-bs-target="#quickk_view" data-bs-toggle="modal"><i class="lnr lnr-magnifier"></i></a>#}
  {#                          </div>#}
                  </div>
                </div> <!-- end single list item -->
              </div>
            {% endfor %}
        </div>
        <div class="paginatoin-area style-2 pt-35 pb-20">
          <div class="row">
            <div class="col-sm-6">
              <div class="pagination-area">
                <p>Showing {{ data.showing_from }} to {{ data.showing_to }} of {{ data.total_items }} ({{ data.total_pages }} Pages)</p>
              </div>
            </div>
            <div class="col-sm-6">
              {% if data.total_pages > 1 %}
                <ul class="pagination-box pagination-style-2">
                  {% if data.current_page > 1 %}
                    <li><a class="Previous" href="{{ path('sinratoPages_find', {'search': data.search_query, 'per_page': data.per_page, 'sort_by': data.sort_by, 'page': data.current_page - 1}) }}">Previous</a></li>
                  {% else %}
                    <li class="disabled">Previous</li>
                  {% endif %}

                  {% set start = max(1, data.current_page - 2) %}
                  {% set end = min(data.total_pages, start + 4) %}
                  {% set start = max(1, end - 4) %}

                  {% if start > 1 %}
                    <li><a href="{{ path('sinratoPages_find', {'search': data.search_query, 'per_page': data.per_page, 'sort_by': data.sort_by, 'page': 1}) }}">1</a></li>
                    {% if start > 2 %}
                      <li class="disabled">...</li>
                    {% endif %}
                  {% endif %}

                  {% for i in start..end %}
                    {% if i == data.current_page %}
                      <li class="active">{{ i }}</li>
                    {% else %}
                      <li><a href="{{ path('sinratoPages_find', {'search': data.search_query, 'per_page': data.per_page, 'sort_by': data.sort_by, 'page': i}) }}">{{ i }}</a></li>
                    {% endif %}
                  {% endfor %}

                  {% if end < data.total_pages %}
                    {% if end < data.total_pages - 1 %}
                      <li class="disabled">...</li>
                    {% endif %}
                    <li><a href="{{ path('sinratoPages_find', {'search': data.search_query, 'per_page': data.per_page, 'sort_by': data.sort_by, 'page': data.total_pages}) }}">{{ data.total_pages }}</a></li>
                  {% endif %}

                  {% if data.current_page < data.total_pages %}
                    <li><a class="Next" href="{{ path('sinratoPages_find', {'search': data.search_query, 'per_page': data.per_page, 'sort_by': data.sort_by, 'page': data.current_page + 1}) }}">Next</a></li>
                  {% else %}
                    <li class="disabled">Next</li>
                  {% endif %}
                </ul>
              {% endif %}
            </div>
          </div>
        </div>
      </div>
      </div>
{#      <div class="col-lg-3">#}
{#        <div class="shop-sidebar-inner mb-30">#}
{#          <!-- filter-price-content start -->#}
{#          <div class="single-sidebar mb-45">#}
{#            <div class="sidebar-inner-title mb-25">#}
{#              <h3>Filter by price</h3>#}
{#            </div>#}
{#            <div class="sidebar-content-box">#}
{#              <div class="filter-price-content">#}
{#                <form action="#" method="post">#}
{#                  <div id="price-slider" class="price-slider ui-slider ui-slider-horizontal ui-widget ui-widget-content ui-corner-all" data-min="{{ data.min_price }}" data-max="{{ data.max_price }}">#}
{#                    <div class="ui-slider-range ui-widget-header ui-corner-all"></div>#}
{#                    <span class="ui-slider-handle ui-state-default ui-corner-all" tabindex="0"></span>#}
{#                    <span class="ui-slider-handle ui-state-default ui-corner-all" tabindex="0"></span>#}
{#                  </div>#}
{#                  <div class="filter-price-wapper">#}
{#                    <div class="filter-price-cont">#}
{#                      <div class="input-type">#}
{#                        <input id="min-price" readonly="" type="text" value="{{ data.min_price|number_format(2, '.', ',') }}">#}
{#                      </div>#}
{#                      <div class="input-type">#}
{#                        <input id="max-price" readonly="" type="text" value="{{ data.max_price|number_format(2, '.', ',') }}">#}
{#                      </div>#}
{#                    </div>#}
{#                  </div>#}
{#                </form>#}
{#              </div>#}
{#            </div>#}
{#          </div>#}
{#          <!-- filter price end -->#}
{#          <!-- brands filter start -->#}
{#          <div class="single-sidebar mb-45">#}
{#            <div class="sidebar-inner-title mb-25">#}
{#              <h3>Brands</h3>#}
{#            </div>#}
{#            <div class="sidebar-content-box">#}
{#              <div class="filter-attribute-container">#}
{#                <ul>#}
{#                  {% for brand, count in data.brands %}#}
{#                    <li><a href="#">{{ brand }} ({{ count }})</a></li>#}
{#                  {% endfor %}#}
{#                </ul>#}
{#              </div>#}
{#            </div>#}
{#          </div>#}
{#          <!-- brands filter end -->#}
{#        </div>#}
{#      </div>#}
      </div>

    {% else %}
      <h2 class="text-center pb-35">No results found for "{{ data.search_query }}"</h2>
    {% endif %}
  </div>
</div>
<!-- shop page main wrapper end -->

<script>
  document.addEventListener('DOMContentLoaded', function() {
    $('select').niceSelect();

    function updateFilters() {
      const perPageSelect = $('#per-page-select').val();
      const sortBySelect = $('#sort-by-select').val();

      const currentUrl = new URL(window.location.href);
      currentUrl.searchParams.set('per_page', perPageSelect);
      currentUrl.searchParams.set('sort_by', sortBySelect);
      window.location.href = currentUrl.toString();
    }

    $('#per-page-select').on('change', updateFilters);
    $('#sort-by-select').on('change', updateFilters);
  });
</script>
